version: '3.8'

services:                                                                 
  app:                                                                    
    volumes:                                                              
      - ./searcher/data:/app/data
    build:                                                                
      context: ./searcher
    ports:
      - "8000:8000"
                                                                              
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:8.13.4
    container_name: es01
    environment:
      - discovery.type=single-node
      - ES_JAVA_OPTS=-Xms512m -Xmx512m
    ulimits:
      memlock:
        soft: -1
        hard: -1
    mem_limit: 1g
    ports:                                                                
      - "9200:9200"                                                       
    networks:                                                             
      - elastic                                                           

  next-app:
    ports:
      - "3000:3000"
    build:
      context: ./searcher-next-app
                                                                          
networks:                                                                 
  elastic:                                                                
    driver: bridge 
